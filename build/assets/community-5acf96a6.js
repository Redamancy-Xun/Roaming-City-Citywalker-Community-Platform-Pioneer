import{_ as w}from"./Back-31df5cd7.js";import{_ as B}from"./footer.vue_vue_type_script_setup_true_lang-d3470474.js";import{u as P,i as a,o as b,j as x,c as d,b as o,F as _,k as E,l as I,e as H,r as h,n as L,a as c,m as F,p as A,h as C}from"./index-c336339f.js";import{c as M}from"./community_card-2e2d9027.js";import{A as N}from"./Citywalker-5c40621a.js";import{u as U}from"./userStore-afec8895.js";import{_ as V}from"./_plugin-vue_export-helper-c27b6911.js";/* empty css                                                                   */const f=s=>(A("data-v-a58c4e87"),s=s(),C(),s),Y=f(()=>o("img",{src:w},null,-1)),j=[Y],z=f(()=>o("span",null,"社区",-1)),G={class:"image-container"},T={__name:"community",setup(s){const v=P(),g=U(),k=new N,r=a([]),t=a(!1),i=a(!0),y=()=>{h.back()},S=()=>{h.push("/post")},l=a(1),u=async()=>{if(!t.value&&i.value){t.value=!0;try{const e=await k.post.getPostListUsingGet({orderByPopularity:!0,page:l.value,pageSize:70},{session:g.sessionId});e.data.result.length>0?(r.value.push(...e.data.result),l.value++):i.value=!1,console.log(e.data),await L(),v.restoreScrollPosition()}catch(e){console.error("获取帖子失败",e)}t.value=!1}},m=()=>{const e=window.scrollY,p=document.documentElement.clientHeight,n=document.documentElement.scrollHeight;e+p>=n-10&&!t.value&&u()};return b(()=>{window.addEventListener("scroll",m),u()}),x(()=>{window.removeEventListener("scroll",m)}),(e,p)=>(c(),d(_,null,[o("header",null,[o("div",{class:"back-icon",onClick:y},j),z,o("div",{class:"post-button",onClick:S}," 发布帖子 ")]),o("main",null,[o("div",G,[(c(!0),d(_,null,E(I(r),n=>(c(),F(M,{key:n.id,post:n},null,8,["post"]))),128))])]),H(B)],64))}},W=V(T,[["__scopeId","data-v-a58c4e87"]]);export{W as default};
