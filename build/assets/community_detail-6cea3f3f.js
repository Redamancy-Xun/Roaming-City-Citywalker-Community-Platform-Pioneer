import{_ as O}from"./Back-64c2790a.js";/* empty css                                                                   */import{i as h,m as H,A as J,a,c as i,b as s,t as p,e as C,w as I,F as f,j as b,k as K,f as Q,u as m,n as B,v as W,x as X,I as Y,p as $,h as V,l as Z,o as ss,r as ts}from"./index-7421df47.js";import{_ as q}from"./_plugin-vue_export-helper-c27b6911.js";/* empty css              *//* empty css              */import{_ as z}from"./profilepic-4b550c51.js";import{_ as es}from"./arrow_right-e14cfa66.js";import{A}from"./Citywalker-1838a2bc.js";import{u as T}from"./userStore-b1331fcf.js";import{S as os,a as as}from"./index-03c1dd54.js";import{I as is}from"./index-1a41a3f5.js";import"./index-dcd1bf9c.js";import"./use-touch-fbe6bb65.js";import"./use-scope-id-02176d93.js";import"./index-05100a24.js";const N=""+new URL("liked-14e20e96.svg",import.meta.url).href,R=""+new URL("like-ba5d8f5c.svg",import.meta.url).href,ns=""+new URL("collected-6f4543eb.svg",import.meta.url).href,cs=""+new URL("collect-397c9166.svg",import.meta.url).href,rs=""+new URL("comment-52ace545.svg",import.meta.url).href;const u=r=>($("data-v-1df85ed8"),r=r(),V(),r),ls={class:"container"},ds={class:"title"},ps=u(()=>s("div",{class:"invitation"},[s("div",{class:"profile-pic"},[s("img",{src:z,class:"profile"}),s("span",{class:"username"},"李虾仁")])],-1)),_s=["src","onClick"],ms={class:"route"},us=u(()=>s("img",{src:es},null,-1)),ks={class:"content"},hs=u(()=>s("div",{class:"tags"},[s("span",{class:"tag"},"#记录"),s("span",{class:"tag"},"#一起citywalk")],-1)),gs=u(()=>s("div",{class:"divider"},null,-1)),vs={class:"comments"},fs=u(()=>s("img",{src:z,class:"comment-avatar"},null,-1)),ys={class:"comment-author"},ws={class:"comment-content"},Is={class:"like-section"},Cs=["onClick"],Ls=["onClick"],Ps={class:"like-count"},xs={class:"footer-content"},Ss={class:"textnum"},Us={class:"textnum"},bs=u(()=>s("img",{src:rs,class:"icon"},null,-1)),Bs={class:"textnum"},Ns={__name:"community_detail_card",props:{postdata:{type:Object,required:!0}},setup(r){const t=r,l=new A,n=T(),d=h(""),y={1:"繁花路线",2:"历史梧桐",3:"小资愚园",4:"甜爱多伦",5:"不夜沪上",6:"购物天堂",7:"轮渡漫游",8:"都市风光",9:"别样外滩",10:"疗愈滨江",11:"巨富长线",12:"淮海中路"},w=H(()=>y[t.postdata.routeId]||"未知路线"),_=h([]),L=e=>{v.value=e,g.value=!0},g=h(!1),v=h(0),D=e=>{v.value=e},E=async()=>{if(!d.value.trim())return;const e={content:d.value,postId:t.postdata.id,images:[]},c={session:n.sessionId};try{const k=await l.comment.createCommentUsingPost(e,c);console.log(k),console.log(e),d.value="",await P()}catch(k){console.error(k)}},P=async()=>{try{const e=await l.comment.getCommentListUsingGet({orderByPopularity:!0,page:1,pageSize:10,postId:t.postdata.id},{session:n.sessionId});_.value=e.data.result,console.log(_.value)}catch(e){console.error("Error fetching comments:",e)}};J(()=>t.postdata.id,(e,c)=>{e!==c&&e&&P()},{immediate:!0});const x=async()=>{try{t.postdata.isLike?(await l.like.unlikePostUsingPost({id:t.postdata.id,type:0},{session:n.sessionId}),t.postdata.isLike=!1,t.postdata.likes--):(await l.like.likePostUsingPost({id:t.postdata.id,type:0},{session:n.sessionId}),t.postdata.isLike=!0,t.postdata.likes++)}catch(e){t.postdata.isLike?console.error("取消点赞失败:",e):console.error("点赞帖子失败:",e)}},S=async e=>{try{e.isLike?(await l.like.unlikePostUsingPost({id:e.id,type:1},{session:n.sessionId}),e.isLike=!1,e.likes--):(await l.like.likePostUsingPost({id:e.id,type:1},{session:n.sessionId}),e.isLike=!0,e.likes++)}catch(c){e.isLike?console.error("取消点赞失败:",c):console.error("点赞帖子失败:",c)}},U=async()=>{try{if(t.postdata.isStar){const e=await l.star.unstarPostUsingPost({postId:t.postdata.id},{session:n.sessionId});t.postdata.isStar=!1,t.postdata.stars--}else{const e=await l.star.starPostUsingPost({postId:t.postdata.id},{session:n.sessionId});t.postdata.isStar=!0,t.postdata.stars++}}catch(e){t.postdata.isCollected?console.error("取消收藏帖子失败:",e):console.error("收藏帖子失败:",e)}};return(e,c)=>{const k=os,F=as,G=is;return a(),i(f,null,[s("div",ls,[s("header",null,[s("span",ds,p(t.postdata.title),1)]),s("main",null,[ps,C(F,{"lazy-render":""},{default:I(()=>[(a(!0),i(f,null,b(t.postdata.images,(o,M)=>(a(),K(k,{key:o,class:"zoom"},{default:I(()=>[s("img",{src:o,class:"img",onClick:()=>L(M)},null,8,_s)]),_:2},1024))),128))]),_:1}),C(G,{show:m(g),"onUpdate:show":c[0]||(c[0]=o=>B(g)?g.value=o:null),images:t.postdata.images,"start-position":m(v),onChange:D},{index:I(()=>[Q("第"+p(m(v)+1)+"页",1)]),_:1},8,["show","images","start-position"]),s("div",ms,[s("span",null,p(m(w)),1),us]),s("div",ks,p(t.postdata.content),1),hs,gs,s("div",vs,[(a(!0),i(f,null,b(m(_),o=>(a(),i("div",{class:"comment",key:o.id},[fs,s("span",ys,p(o.userName),1),s("span",ws,p(o.content),1),s("div",Is,[o.isLike?(a(),i("img",{key:0,src:N,class:"comment-like",onClick:()=>S(o)},null,8,Cs)):(a(),i("img",{key:1,src:R,class:"comment-like",onClick:()=>S(o)},null,8,Ls)),s("span",Ps,p(o.likes),1)])]))),128))])])]),s("div",xs,[W(s("input",{type:"text",placeholder:"发评论...",class:"comment-input","onUpdate:modelValue":c[1]||(c[1]=o=>B(d)?d.value=o:null)},null,512),[[X,m(d)]]),t.postdata.isLike?(a(),i("img",{key:0,src:N,class:"icon",onClick:x})):(a(),i("img",{key:1,src:R,class:"icon",onClick:x})),s("span",Ss,p(t.postdata.likes),1),t.postdata.isStar?(a(),i("img",{key:2,src:ns,class:"icon",onClick:U})):(a(),i("img",{key:3,src:cs,class:"icon",onClick:U})),s("span",Us,p(t.postdata.stars),1),bs,s("span",Bs,p(t.postdata.comments),1),m(d)?(a(),i("button",{key:4,class:"send-button",onClick:E},"发送")):Y("",!0)])],64)}}},Rs=q(Ns,[["__scopeId","data-v-1df85ed8"]]);const j=r=>($("data-v-b6315909"),r=r(),V(),r),$s=j(()=>s("img",{src:O},null,-1)),Vs=[$s],qs=j(()=>s("span",null,"社区",-1)),zs={class:"image-container"},As={__name:"community_detail",setup(r){const t=T(),l=new A,n=Z(),d=h([]),y=()=>{ts.back()},w=async()=>{try{const _=await l.post.getPostByIdUsingGet({postId:n.query.id},{session:t.sessionId});console.log(_.data),d.value=_.data.result}catch(_){console.error("获取帖子失败",_)}};return ss(()=>{console.log(n.query.id),w()}),(_,L)=>(a(),i(f,null,[s("header",null,[s("div",{class:"back-icon",onClick:y},Vs),qs]),s("main",null,[s("div",zs,[C(Rs,{postdata:m(d)},null,8,["postdata"])])])],64))}},st=q(As,[["__scopeId","data-v-b6315909"]]);export{st as default};
