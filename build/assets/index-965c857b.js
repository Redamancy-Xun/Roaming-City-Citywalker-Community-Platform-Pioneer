import{d as _,Q as ee,q as L,e as d,G as T,R as N,H as oe,s as B,i as w,N as ne,T as j,D as K,I as U,n as te,o as ae,S as se,U as le,V as ce,F as re}from"./index-c336339f.js";import{c as x,v as ie,R as de,a as C,n as I,w as E,t as y,q as F,M as ue,S as fe,T as ve,z as G,N as H,e as M,U as me,h as V,u as ye,V as Ie,j as he,H as ge}from"./use-touch-78a9110c.js";let Pe=2e3;const Oe=()=>++Pe,[Se,je]=x("config-provider"),be=Symbol(Se),[Ce,A]=x("icon"),we=e=>e==null?void 0:e.includes("/"),xe={dot:Boolean,tag:C("i"),name:String,size:I,badge:I,color:String,badgeProps:Object,classPrefix:String};var ke=_({name:Ce,props:xe,setup(e,{slots:o}){const n=ee(be,null),i=L(()=>e.classPrefix||(n==null?void 0:n.iconPrefix)||A());return()=>{const{tag:s,dot:c,name:a,size:l,badge:h,color:m}=e,r=we(a);return d(de,T({dot:c,tag:s,class:[i.value,r?"":`${i.value}-${a}`],style:{color:m,fontSize:ie(l)},content:h},e.badgeProps),{default:()=>{var u;return[(u=o.default)==null?void 0:u.call(o),r&&d("img",{class:A("image"),src:a},null)]}})}}});const ze=E(ke),Y={show:Boolean,zIndex:I,overlay:y,duration:I,teleport:[String,Object],lockScroll:y,lazyRender:y,beforeClose:Function,overlayStyle:Object,overlayClass:F,transitionAppear:Boolean,closeOnClickOverlay:y},Ke=Object.keys(Y);let P=0;const D="van-overflow-hidden";function Te(e,o){const n=ue(),i="01",s="10",c=r=>{n.move(r);const u=n.deltaY.value>0?s:i,k=ve(r.target,e.value),{scrollHeight:g,offsetHeight:O,scrollTop:S}=k;let f="11";S===0?f=O>=g?"00":"01":S+O>=g&&(f="10"),f!=="11"&&n.isVertical()&&!(parseInt(f,2)&parseInt(u,2))&&G(r,!0)},a=()=>{document.addEventListener("touchstart",n.start),document.addEventListener("touchmove",c,{passive:!1}),P||document.body.classList.add(D),P++},l=()=>{P&&(document.removeEventListener("touchstart",n.start),document.removeEventListener("touchmove",c),P--,P||document.body.classList.remove(D))},h=()=>o()&&a(),m=()=>o()&&l();fe(h),N(m),oe(m),B(o,r=>{r?a():l()})}function Z(e){const o=w(!1);return B(e,n=>{n&&(o.value=n)},{immediate:!0}),n=>()=>o.value?n():null}const p=()=>{var e;const{scopeId:o}=((e=ne())==null?void 0:e.vnode)||{};return o?{[o]:""}:null},[_e,Be]=x("overlay"),Ee={show:Boolean,zIndex:I,duration:I,className:F,lockScroll:y,lazyRender:y,customStyle:Object};var Re=_({name:_e,props:Ee,setup(e,{slots:o}){const n=w(),i=Z(()=>e.show||!e.lazyRender),s=a=>{e.lockScroll&&G(a,!0)},c=i(()=>{var a;const l=M(me(e.zIndex),e.customStyle);return V(e.duration)&&(l.animationDuration=`${e.duration}s`),K(d("div",{ref:n,style:l,class:[Be(),e.className]},[(a=o.default)==null?void 0:a.call(o)]),[[U,e.show]])});return H("touchmove",s,{target:n}),()=>d(j,{name:"van-fade",appear:!0},{default:c})}});const Ae=E(Re),De=M({},Y,{round:Boolean,position:C("center"),closeIcon:C("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:C("top-right"),safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[pe,$]=x("popup");var $e=_({name:pe,inheritAttrs:!1,props:De,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:o,attrs:n,slots:i}){let s,c;const a=w(),l=w(),h=Z(()=>e.show||!e.lazyRender),m=L(()=>{const t={zIndex:a.value};if(V(e.duration)){const v=e.position==="center"?"animationDuration":"transitionDuration";t[v]=`${e.duration}s`}return t}),r=()=>{s||(s=!0,a.value=e.zIndex!==void 0?+e.zIndex:Oe(),o("open"))},u=()=>{s&&he(e.beforeClose,{done(){s=!1,o("close"),o("update:show",!1)}})},k=t=>{o("clickOverlay",t),e.closeOnClickOverlay&&u()},g=()=>{if(e.overlay)return d(Ae,T({show:e.show,class:e.overlayClass,zIndex:a.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0},p(),{onClick:k}),{default:i["overlay-content"]})},O=t=>{o("clickCloseIcon",t),u()},S=()=>{if(e.closeable)return d(ze,{role:"button",tabindex:0,name:e.closeIcon,class:[$("close-icon",e.closeIconPosition),ge],classPrefix:e.iconPrefix,onClick:O},null)};let f;const q=()=>{f&&clearTimeout(f),f=setTimeout(()=>{o("opened")})},Q=()=>o("closed"),W=t=>o("keydown",t),J=h(()=>{var t;const{round:v,position:b,safeAreaInsetTop:z,safeAreaInsetBottom:X}=e;return K(d("div",T({ref:l,style:m.value,role:"dialog",tabindex:0,class:[$({round:v,[b]:b}),{"van-safe-area-top":z,"van-safe-area-bottom":X}],onKeydown:W},n,p()),[(t=i.default)==null?void 0:t.call(i),S()]),[[U,e.show]])}),R=()=>{const{position:t,transition:v,transitionAppear:b}=e,z=t==="center"?"van-fade":`van-popup-slide-${t}`;return d(j,{name:v||z,appear:b,onAfterEnter:q,onAfterLeave:Q},{default:J})};return B(()=>e.show,t=>{t&&!s&&(r(),n.tabindex===0&&te(()=>{var v;(v=l.value)==null||v.focus()})),!t&&s&&(s=!1,o("close"))}),ye({popupRef:l}),Te(l,()=>e.show&&e.lockScroll),H("popstate",()=>{e.closeOnPopstate&&(u(),c=!1)}),ae(()=>{e.show&&r()}),se(()=>{c&&(o("update:show",!0),c=!1)}),N(()=>{e.show&&e.teleport&&(u(),c=!0)}),le(Ie,()=>e.show),()=>e.teleport?d(ce,{to:e.teleport},{default:()=>[g(),R()]}):d(re,null,[g(),R()])}});const Ue=E($e);export{ze as I,Ue as P,Ke as a,Y as p,p as u};
